cmake_minimum_required(VERSION 3.16)
project(ZoomMeetingBot)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Set Zoom SDK path
set(ZOOM_SDK_PATH ${CMAKE_SOURCE_DIR}/..)

# Include directories
include_directories(${ZOOM_SDK_PATH}/h)
include_directories(${CMAKE_SOURCE_DIR}/src)

# Find required libraries
find_package(PkgConfig REQUIRED)
pkg_check_modules(JSONCPP jsoncpp)
include_directories(${JSONCPP_INCLUDE_DIRS})

# Link directories
link_directories(${ZOOM_SDK_PATH})

# Real Zoom SDK bot executable
add_executable(zoom_meeting_bot src/real_zoom_bot.cpp)

# Link libraries
target_link_libraries(zoom_meeting_bot
    ${ZOOM_SDK_PATH}/libmeetingsdk.so
    ${JSONCPP_LIBRARIES}
    pthread
    dl
    m
)

# Set runtime library path
set_target_properties(zoom_meeting_bot PROPERTIES
    INSTALL_RPATH "${ZOOM_SDK_PATH}:${ZOOM_SDK_PATH}/qt_libs/Qt/lib"
    BUILD_WITH_INSTALL_RPATH TRUE
)

# Installation
install(TARGETS zoom_meeting_bot DESTINATION bin)